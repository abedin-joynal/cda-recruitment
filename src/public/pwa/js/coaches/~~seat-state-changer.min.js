var seatStateChanger={};console.log(HOSTURL),seatStateChanger.update1=function(data){let $this=this;console.log("Polled Seat Data1: "+JSON.stringify(data.emitted_data));let seat_info_str=data.seat_info;_.each(data.emitted_data,(function(element,index,list){let $coach_elem=$(`.coach-element[data-coach-id='${element.coach_id}']`);if($coach_elem.attr("data-seat-info",seat_info_str),"object"==typeof element.seat_no)for(let seat_no of element.seat_no){let $seat=$coach_elem.find(`.${seat_no}`),seat_status=element.seat_status,ss=SEAT_STATUS[seat_status],seat_info_json,cur_seat_info=JSON.parse(seat_info_str)[seat_no];$this[ss.callback]($seat,ss,cur_seat_info),$seat.attr("data-seat-status",seat_status)}$coach_elem.attr("data-counter-view",0),generateCounterWiseView($coach_elem)}))},seatStateChanger.update=function($coach_elem,seat_info_json){let $this=this;_.each(seat_info_json,(function(si,seat_no,list){let $seat=$coach_elem.find(`.${seat_no}`),seat_status=parseInt(si.status),ss=SEAT_STATUS[seat_status];void 0!==ss&&($seat.attr("data-seat-status",seat_status),$this[ss.callback]($seat,ss,si))})),$coach_elem.attr("data-counter-view",0)},seatStateChanger.processing=function($seat,ss,cur_seat_info){1==CUR_USER_INFO.user_type&&cur_seat_info.occupying_user_id==CUR_USER_INFO.id||2==CUR_USER_INFO.user_type&&cur_seat_info.occupying_customer_id==CUR_USER_INFO.unique_customer_id&&null!==CUR_USER_INFO.unique_customer_id?(this.removeAllSeatClasses($seat),$seat.addClass(ss.class),this.addSeatToSelectedList($seat)):(this.removeAllSeatClasses($seat),$seat.addClass("s-blocked"))},seatStateChanger.available=function($seat,ss,seat_info_str){this.removeAllSeatClasses($seat),$seat.addClass("s-available"),this.removeSeatFromSelectedList($seat)},seatStateChanger.bookedFemale=function($seat,ss,seat_info_str){this.removeAllSeatClasses($seat),$seat.addClass("s-booked-female")},seatStateChanger.bookedMale=function($seat,ss,seat_info_str){this.removeAllSeatClasses($seat),$seat.addClass("s-booked-male")},seatStateChanger.soldMale=function($seat,ss,seat_info_str){this.removeAllSeatClasses($seat),$seat.addClass("s-sold-male")},seatStateChanger.soldFemale=function($seat,ss,seat_info_str){this.removeAllSeatClasses($seat),$seat.addClass("s-sold-female")},seatStateChanger.blocked=function($seat,ss,seat_info_str){this.removeAllSeatClasses($seat),$seat.addClass("s-blocked")},seatStateChanger.addSeatToSelectedList=function($seat){let $coach_elem=$seat.closest(".coach-element");$selected_seat_list=$coach_elem.find(".selected-seat-list");let route_preference=JSON.parse($coach_elem.attr("data-route-preference")),seat_type=$seat.attr("data-seat-type"),seat_no=$seat.attr("data-seat-no"),exists;if(!($selected_seat_list.find(`[data-seat-no='${seat_no}']`).length>0)){let fare="regular"==seat_type?$coach_elem.attr("data-fare-regular"):$coach_elem.attr("data-fare-business"),sslm=`<li class="list-group-item d-flex justify-content-between align-items-center selected-seat-li" \n                            data-fare="${fare}" data-seat-no="${seat_no}">\n                            <span class="label">${seat_no}</span>\n                            <span class="badge badge-site badge-pill"><span class="fare">${fare}</span>Tk</span>\n                        </li>`;$coach_elem.find(".selected-seat-list-container").removeClass("d-none"),$selected_seat_list.find("li:last").before(sslm)}this.calculateTotalFare($coach_elem)},seatStateChanger.removeSeatFromSelectedList=function($seat){let seat_no=$seat.attr("data-seat-no"),$coach_elem=$seat.closest(".coach-element");$selected_seat_list=$coach_elem.find(".selected-seat-list"),$selected_seat_list.find(`li[data-seat-no='${seat_no}']`).remove(),this.calculateTotalFare($coach_elem)},seatStateChanger.removeAllSeatClasses=function($seat){$seat.removeClass("s-processing").removeClass("s-available").removeClass("s-booked-male").removeClass("s-booked-female").removeClass("s-sold-male").removeClass("s-sold-female").removeClass("s-blocked")},seatStateChanger.releaseAllSelectedSeats=async function(){let occupying_user_id=CUR_USER_INFO.id,occupying_user_type=CUR_USER_INFO.user_type,occupying_customer_id=CUR_USER_INFO.unique_customer_id,res=await axios.get(HOSTURL+"/coaches/release-all-seats",{params:{occupying_user_id:occupying_user_id,occupying_user_type:occupying_user_type,occupying_customer_id:occupying_customer_id}})},seatStateChanger.emptySelectedList=function($coach_elem){$selected_seat_list=$coach_elem.find(".selected-seat-list"),$selected_seat_list.find("li").not("li:last").remove(),this.calculateTotalFare($coach_elem)},seatStateChanger.resetPassengerInfo=function($elem){let $coach_elem,$pif;$elem.closest(".coach-element").find(".passenger-info-form")[0].reset()},seatStateChanger.calculateTotalFare=function($coach_elem){$selected_seat_list_con=$coach_elem.find(".selected-seat-list-container"),$selected_seat_list=$coach_elem.find(".selected-seat-list");let lis=$selected_seat_list.find(".selected-seat-li");lis.length>=1?$selected_seat_list_con.removeClass("d-none"):$selected_seat_list_con.addClass("d-none");let total_fare=0;lis.each((function(){let fare=$(this).attr("data-fare");total_fare+=parseFloat(fare)})),$selected_seat_list.find(".total-fare").html(`${total_fare} Tk`)},seatStateChanger.recalibrateSelectedSeatFares=function($coach_elem){let $seats=$coach_elem.find(".seat[data-seat-status='0']"),$this=this;$seats.each((function(){0==$(this).attr("data-seat-status")&&($this.removeSeatFromSelectedList($(this)),$this.addSeatToSelectedList($(this)))}))};